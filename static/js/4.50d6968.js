(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[4],{"9w90":function(t,e,s){"use strict";var a=s("X6Nj"),i=s.n(a);i.a},X6Nj:function(t,e,s){},ez0Y:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-layout",{attrs:{view:"hHh LpR lFf"}},[s("q-layout-header",{staticClass:"print-hide"},[s("q-toolbar",{staticClass:"q-py-sm",attrs:{color:"dark",glossy:""}},[s("q-btn",{attrs:{fab:"",color:"green",glossy:""},on:{click:function(e){t.leftDrawerOpen=!t.leftDrawerOpen}}},[s("q-spinner-grid")],1),s("q-toolbar-title",[t._v("\n        Лесное дело\n        "),s("div",{attrs:{slot:"subtitle"},slot:"subtitle"},[t._v("Версия: "+t._s(t.$store.state.main.version))])]),s("div",{staticClass:"group"},[s("q-btn",{staticClass:"relative-position",attrs:{icon:"mail",round:"",dense:"",color:"deep-orange",size:"form-label",glossy:""},nativeOn:{click:function(e){t.$router.push("/messages/")}}},[t.new_messages?s("q-chip",{staticClass:"absolute-bottom-right",staticStyle:{bottom:"-5px"},attrs:{color:"red",small:""}},[t._v(t._s(t.new_messages))]):t._e()],1),s("q-btn",{attrs:{icon:"event_note",round:"",dense:"",color:"green",size:"form-label",glossy:""},nativeOn:{click:function(e){t.$router.push("/tasks/view/inbox")}}},[t.new_tasks?s("q-chip",{staticClass:"absolute-bottom-right",staticStyle:{bottom:"-5px"},attrs:{color:"red",small:""}},[t._v(t._s(t.new_tasks))]):t._e()],1)],1)],1)],1),s("q-layout-drawer",{attrs:{overlay:""},model:{value:t.leftDrawerOpen,callback:function(e){t.leftDrawerOpen=e},expression:"leftDrawerOpen"}},[s("q-list",{staticClass:"no-padding ",attrs:{link:"",sparse:"","no-border":"",separators:""}},[s("q-item",{staticClass:"shadow-1"},[s("q-item-side",{attrs:{avatar:""}},[s("img",{staticClass:"avatar",attrs:{src:t.$user.avatar}})]),s("q-item-main",[s("q-item-tile",[t._v("\n                "+t._s(t.$user.first_name)+"\n                "+t._s(t.$user.last_name)+"\n              ")]),s("q-item-tile",{attrs:{sublabel:""}},[t._v(t._s(t.$user.position))])],1)],1),s("q-item",{nativeOn:{click:function(e){t.$router.push("/tasks")}}},[s("q-item-side",{attrs:{icon:"event_note",color:"secondary"}}),s("q-item-main",{attrs:{label:"Задачи"}}),s("q-item-side",{attrs:{label:""}},[t.new_tasks?s("q-chip",{attrs:{color:"positive",small:""}},[t._v(t._s(t.new_tasks))]):t._e()],1)],1),s("q-item",{nativeOn:{click:function(e){t.$router.push("/messages")}}},[s("q-item-side",{attrs:{icon:"mail",color:"secondary"}}),s("q-item-main",{attrs:{label:"Сообщения"}}),s("q-item-side",{attrs:{label:""}},[t.new_messages?s("q-chip",{attrs:{color:"positive",small:""}},[t._v(t._s(t.new_messages))]):t._e()],1)],1),s("q-item",{nativeOn:{click:function(e){t.docsDialog=!t.docsDialog}}},[s("q-item-side",{attrs:{icon:"assignment",color:"secondary"}}),s("q-item-main",{attrs:{label:"Документы"}}),s("q-modal",{model:{value:t.docsDialog,callback:function(e){t.docsDialog=e},expression:"docsDialog"}},[s("q-toolbar",{attrs:{color:"tertiary",glossy:""}},[s("q-toolbar-title",[t._v("\n                    Документы\n                  ")]),s("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"close"},nativeOn:{click:function(e){t.docsDialog=!t.docsDialog}}})],1),s("q-list",{attrs:{link:"",sparse:"",separator:""}},[s("q-item",{nativeOn:{click:function(e){t.$router.push("/docs/waybills")}}},[s("q-item-side",{attrs:{icon:"directions_car",color:"primary"}}),s("q-item-main",{attrs:{label:"Путевые листы"}})],1),s("q-item",{nativeOn:{click:function(e){t.$router.push({name:"OutfitList"})}}},[s("q-item-side",{attrs:{icon:"work",color:"primary"}}),s("q-item-main",{attrs:{label:"Наряды-акты"}})],1),s("q-item",{nativeOn:{click:function(e){t.$router.push("/docs/tractor-regform")}}},[s("q-item-side",{attrs:{icon:"settings_applications",color:"primary"}}),s("q-item-main",{attrs:{label:"Учетные листы тракториста"}})],1),s("q-item",{nativeOn:{click:function(e){t.$router.push({name:"SvodnayaVedomost"})}}},[s("q-item-side",{attrs:{icon:"format_bold",color:"primary"}}),s("q-item-main",{attrs:{label:"Сводные ведомости"}})],1),s("q-item",{nativeOn:{click:function(e){t.$router.push({name:"NakopitelnayaVedomost"})}}},[s("q-item-side",{attrs:{icon:"attach_money",color:"primary"}}),s("q-item-main",{attrs:{label:"Накопительные ведомости"}})],1),s("q-item",{nativeOn:{click:function(e){t.$router.push({name:"WorkTimeTable"})}}},[s("q-item-side",{attrs:{icon:"watch_later",color:"primary"}}),s("q-item-main",{attrs:{label:"Табеля учёта рабочего времени"}})],1),s("q-item",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],nativeOn:{click:function(e){t.$router.push({name:"MaterialReports"})}}},[s("q-item-side",{attrs:{icon:"category",color:"primary"}}),s("q-item-main",{attrs:{label:"Материальные отчеты"}})],1)],1)],1)],1),s("q-item",{nativeOn:{click:function(e){t.$router.push("/users")}}},[s("q-item-side",{attrs:{icon:"account circle",color:"secondary"}}),s("q-item-main",{attrs:{label:"Сотрудники"}})],1),s("q-item",{nativeOn:{click:function(e){return t.bugReport(e)}}},[s("q-item-side",{attrs:{icon:"bug_report",color:"secondary"}}),s("q-item-main",{attrs:{label:"Сообщить об ошибке"}})],1),s("q-item",{nativeOn:{click:function(e){t.logout()}}},[s("q-item-side",{attrs:{icon:"reply",color:"secondary"}}),s("q-item-main",{attrs:{label:"Выход"}})],1)],1)],1),s("q-page-container",{staticClass:"window-height"},[s("router-view")],1)],1)},i=[];a._withStripped=!0;var n=s("pg2m"),o=function(t,e){if(n["a"].is.cordova&&navigator&&navigator.app)return navigator.app.loadUrl(t,{openExternal:!0});var s=window.open(t,"_blank");if(s)return s.focus(),s;e()},r={name:"LayoutDefault",data:function(){return{leftDrawerOpen:!1,docsDialog:!1,new_messages:0,new_tasks:0}},methods:{bugReport:function(){var t=this;this.$q.dialog({message:"Сообщить об ошибке",color:"primary",ok:{label:"Отправить",color:"green"},cancel:!0,preventClose:!0,prompt:{type:"textarea"}}).then(function(e){if(e){var s={reporter:"/api/v1/users/"+t.$user.username+"/",text:e};t.$axios.post("/api/v1/bug-reports/",s).then(function(e){t.$q.notify({message:"Отчет отправлен!",color:"positive"})}).catch(function(e){t.$q.notify({message:e,color:"negative"})})}}).catch(function(){})},checkNewTasks:function(){var t=this,e={viewed:!1,performer:this.$user.id};this.$axios.get("/api/v1/task/",{params:e}).then(function(e){t.new_tasks=e.data.meta.total_count}).catch(function(t){throw new Error("Ошибка соединения")})},checkNewMessages:function(){var t=this,e={is_new:!0,recipient:this.$user.id};this.$axios.get("/api/v1/messages/",{params:e}).then(function(e){t.new_messages=e.data.meta.total_count}).catch(function(t){throw new Error("Ошибка соединения")})},playSound:function(t){var e=new Audio("static/sounds/"+t);e.play()},openURL:o,logout:function(){this.$auth.logout(this)}},created:function(){var t=this;this.$axios.defaults.headers.common["Authorization"]="ApiKey "+this.$user.username+":"+this.$user.api_key,this.$store.dispatch("main/setAccount"),this.$store.dispatch("main/fetchUsers",this),this.newMessagesCheker=setInterval(this.checkNewMessages,1e4),this.newTasksCheker=setInterval(this.checkNewTasks,2e4),document.onkeydown=function(e){77==e.keyCode&&e.ctrlKey&&(t.leftDrawerOpen=!t.leftDrawerOpen)}},destroyed:function(){clearInterval(this.newMessagesCheker),clearInterval(this.newTasksCheker)},watch:{new_messages:function(t,e){t>e&&this.playSound("new_message.mp3")},new_tasks:function(t,e){t>e&&this.playSound("new_message.mp3")}}},c=r,l=(s("9w90"),s("KHd+")),m=Object(l["a"])(c,a,i,!1,null,null,null);e["default"]=m.exports}}]);