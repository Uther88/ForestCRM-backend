(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[2],{0:function(e,t,n){e.exports=n("LzkT")},"3OSX":function(e,t,n){"use strict";n("pIFo");var a=n("oYx3"),o=n("Kw5r"),i={authenticated:function(){return!!o["a"].ls.get("user")&&(o["a"].prototype.$user=o["a"].ls.get("user"),!0)},login:function(e,t,n,o){var i=new URLSearchParams;i.append("username",t),i.append("password",n),e.$axios.post("/login/",i,{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(n){e.$ls.set("user",n.data),e.$axios.defaults.headers.common["Authorization"]="ApiKey "+t+":"+n.data.api_key,o?a["a"].push(o):a["a"].push("/")}).catch(function(t){e.$q.notify({message:t.message,icon:"error",position:"bottom-right"})})},logout:function(e){e.$ls.clear(),a["a"].replace("/auth")}};o["a"].prototype.$auth=i,t["a"]=function(e){e.app;var t=e.Vue;t.prototype.$auth=i}},"A0++":function(e,t,n){"use strict";var a=n("TOJS"),o=n.n(a);o.a},Hl11:function(e,t,n){},LzkT:function(e,t,n){"use strict";n.r(t);var a={};n.r(a),n.d(a,"getNewMessages",function(){return Re}),n.d(a,"getUsers",function(){return Fe});var o={};n.r(o),n.d(o,"addUsers",function(){return Ne}),n.d(o,"addMessages",function(){return Ue}),n.d(o,"addTasks",function(){return Le}),n.d(o,"addWorkers",function(){return Oe}),n.d(o,"setAccount",function(){return Pe}),n.d(o,"setScreen",function(){return Ae}),n.d(o,"showNewMessage",function(){return ze}),n.d(o,"setRecipient",function(){return Ee});var i={};n.r(i),n.d(i,"setAccount",function(){return Ge}),n.d(i,"fetchUsers",function(){return je}),n.d(i,"showNewMessage",function(){return Ie});n("rGqo"),n("SpHO"),n("oRQL"),n("0UuB"),n("Hl11"),n("fm0S");var r=n("Kw5r"),s=n("U3LY"),l=n("6E/o"),u=n("cFFF"),c=n("IEC1"),p=n("zxLP"),m=n("Rqni"),d=n("MqH6"),f=n("8wy3"),h=n("zmdN"),b=n("SC7v"),v=n("FzGJ"),w=n("nlhR"),g=n("UrUt"),Q=n("EYBb"),y=n("HlXa"),k=n("UG+o"),S=n("lUGP"),x=n("uNnR"),T=n("fUOT"),M=n("WTFv"),$=n("eelU"),q=n("XYut"),C=n("UlvI"),R=n("YYYh"),F=n("S/Rk"),N=n("5X41"),U=n("xWPs"),L=n("vJud"),O=n("xgT5"),P=n("ezih"),A=n("Ztd7"),z=n("lBN4"),E=n("23sU"),G=n("wIFj"),j=n("L0iJ"),I=n("PVu0"),W=n("A9jH"),H=n("tbgk"),V=n("zEqA"),_=n("NjtJ"),D=n("dsqU"),X=n("/GzR"),J=n("k/Uo"),Y=n("978/"),B=n("o2AP"),K=n("jJN+"),Z=n("OMMn"),ee=n("7r/T"),te=n("IG5u"),ne=n("CVJq"),ae=n("KnAT"),oe=n("A4jm"),ie=n("kXp1"),re=n("AOwd"),se=n("3HEz"),le=n("FSbK"),ue=n("K9Ld"),ce=n("Ezub"),pe=n("Z4Cl"),me=n("qaCD"),de=n("dB3m"),fe=n("C64U");r["a"].use(l["a"],{config:{},i18n:s["a"],components:{QLayout:u["a"],QLayoutHeader:c["a"],QLayoutDrawer:p["a"],QPageContainer:m["a"],QPage:d["a"],QToolbar:f["a"],QToolbarTitle:h["a"],QBtn:b["a"],QBtnGroup:v["a"],QBtnDropdown:w["a"],QIcon:g["a"],QList:Q["a"],QListHeader:y["a"],QItem:k["a"],QItemTile:S["a"],QItemMain:x["a"],QItemSide:T["a"],QSelect:M["a"],QField:$["a"],QInput:q["a"],QCheckbox:C["a"],QSearch:R["a"],QChip:F["a"],QChipsInput:N["a"],QTabs:U["a"],QToggle:L["a"],QTable:O["a"],QTd:P["a"],QTr:A["a"],QRouteTab:z["a"],QTab:E["a"],QTabPane:G["a"],QUploader:j["a"],QDatetime:I["a"],QTooltip:W["a"],QPopover:H["a"],QWindowResizeObservable:V["a"],QResizeObservable:_["a"],QChatMessage:D["a"],QScrollObservable:X["a"],QScrollArea:J["a"],QInfiniteScroll:Y["a"],QSpinnerHourglass:B["a"],QSpinnerGrid:K["a"],QSpinnerComment:Z["a"],QPageSticky:ee["a"],QInnerLoading:te["a"],QModal:ne["a"],QModalLayout:ae["a"],QDialog:oe["a"],QStepper:ie["a"],QStep:re["a"],QStepperNavigation:se["a"]},directives:{Ripple:le["a"],CloseOverlay:ue["a"]},plugins:{Notify:ce["a"],Dialog:pe["a"],Loading:me["a"],Cookies:de["a"],ActionSheet:fe["a"]}});var he=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"q-app"}},[n("q-window-resize-observable",{on:{resize:e.onResize}}),n("router-view"),e.$auth.authenticated()?n("new-message-dialog",{ref:"newMessageDialog"}):e._e()],1)},be=[];he._withStripped=!0;var ve=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-modal",{ref:"newMessageModal",attrs:{"content-css":"max-height:100%; border-radius: 4px;"},on:{hide:e.clearMSGForm,show:e.setRecipient},model:{value:e.$store.state.main.showNewMessage,callback:function(t){e.$set(e.$store.state.main,"showNewMessage",t)},expression:"$store.state.main.showNewMessage"}},[n("div",{staticClass:"flex column full-heigh justify-between"},[n("q-toolbar",{staticClass:"self-start"},[n("q-toolbar-title",{staticClass:"col"},[e._v("Новое сообщение")]),n("q-btn",{directives:[{name:"close-overlay",rawName:"v-close-overlay"}],attrs:{icon:"close",flat:""}})],1),n("div",{staticClass:"flex column col-10 q-pa-sm "},[n("q-select",{staticClass:"full-width",attrs:{"float-label":"Кому",filter:"","filter-placeholder":"Поиск","autofocus-filter":"",chips:"",multiple:"",options:e.$store.state.main.users.filter(function(t){return t.id!=e.$store.state.main.user.id}).map(function(e){return{label:e.full_name,value:e.id}})},model:{value:e.form.recipient,callback:function(t){e.$set(e.form,"recipient",t)},expression:"form.recipient"}}),n("q-input",{staticClass:"q-my-sm full-width",attrs:{"float-label":"Тема",clearable:""},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}}),n("q-input",{staticClass:"full-width shadow-1 block q-px-sm",attrs:{type:"textarea","float-label":"Tекст сообщения","max-height":100,rows:8},model:{value:e.form.text,callback:function(t){e.$set(e.form,"text",t)},expression:"form.text"}}),n("q-uploader",{ref:"message_form",staticClass:"generic-margin full-width",attrs:{url:"","float-label":"Файлы:",multiple:"",clearable:"",before:[{icon:"attachment"}],"hide-upload-button":!0,"auto-expand":""},on:{add:e.addFile,"remove:cancel":e.removeFile}})],1),n("q-toolbar",{staticClass:"justify-around group"},[n("q-btn",{attrs:{icon:"backspace",label:"Отчистить",type:"button",color:"deep-orange"},nativeOn:{click:function(t){return e.clearMSGForm(t)}}}),n("q-btn",{attrs:{icon:"send",type:"button",disabled:!e.validateMSGForm,color:e.validateMSGForm?"positive":"negative",label:"Отправить"},nativeOn:{click:function(t){return e.sendMessage(t)}}})],1)],1)])},we=[];ve._withStripped=!0;var ge={data:function(){return{form:{recipient:[],title:null,text:null,files:[]}}},methods:{setRecipient:function(){this.$store.state.main.recipient&&this.form.recipient.push(this.$store.state.main.recipient)},clearMSGForm:function(){this.form.recipient=[],this.form.files=[],this.form.title=null,this.form.text=null,this.$refs["message_form"].reset(),this.$store.commit("main/setRecipient",null)},addFile:function(e){var t=this;e.forEach(function(e){t.form.files.push(e)})},removeFile:function(e){this.form.files=this.form.files.filter(function(t){return t!==e})},sendMessage:function(){var e=this,t=new FormData,n=this.$q.cookies.get("csrftoken"),a={headers:{"X-CSRFToken":n,"X-Requested-With":"XMLHttpRequest","Content-Type":"multipart/form-data"}};t.append("title",this.form.title),t.append("text",this.form.text),t.append("recipient",this.form.recipient);for(var o=0;o<this.form.files.length;o++){var i=this.form.files[o];t.append("files",i)}this.$root.$axios.post("/api/v1/messages/",t,a).then(function(t){e.$refs.newMessageModal.hide()}).catch(function(e){})}},computed:{validateMSGForm:function(){return!!(this.form.title&&this.form.text&&this.form.recipient.length>0)}}},Qe=ge,ye=n("KHd+"),ke=Object(ye["a"])(Qe,ve,we,!1,null,null,null),Se=ke.exports,xe={name:"App",components:{"new-message-dialog":Se},data:function(){return{version:"1.1",screen:{height:0,width:0},newMessageDialog:!1}},methods:{onResize:function(e){this.$store.commit("main/setScreen",e)},handleError:function(e){this.$q.notify({message:e,type:"negative",icon:"error",timeout:2e3,position:"bottom-right"})},logout:function(){Auth.logout(this)}}},Te=xe,Me=(n("A0++"),Object(ye["a"])(Te,he,be,!1,null,null,null)),$e=Me.exports,qe=n("L2JU"),Ce={version:1.1,showNewMessage:!1,recipient:null,users:[],messages:[],tasks:[],user:null,screen:{width:0,height:0},departaments:[{label:"Лес",value:"les"},{label:"Цех",value:"ceh"},{label:"ПХС",value:"phs"},{label:"МТМ",value:"mtm"}],units:[{label:"M³",value:"MC"},{label:"M²",value:"MS"},{label:"Шт",value:"P"},{label:"Га",value:"HE"},{label:"Л",value:"L"},{label:"Км",value:"KM"}],rates:{1:23.63,2:25,3:26.47,4:28.1,5:28.59,6:31.44}},Re=function(e,t,n){return e.messages},Fe=function(e,t,n){return e.users},Ne=function(e,t){e.users=t},Ue=function(e,t){e.messages=t},Le=function(e,t){e.tasks=t},Oe=function(e,t){e.workers=t},Pe=function(e,t){e.user=t},Ae=function(e,t){e.screen.height=t.height,e.screen.width=t.width},ze=function(e,t){e.showNewMessage=t},Ee=function(e,t){e.recipient=t},Ge=function(e){var t=e.commit,n=r["a"].ls.get("user");t("setAccount",n)},je=function(e,t){var n=e.commit;t.$axios.get("/api/v1/users/").then(function(e){n("addUsers",e.data.users)}).catch(function(e){console.log("Error getting users")})},Ie=function(e,t){var n=e.commit;n("showNewMessage",!0),n("setRecipient",t)},We={namespaced:!0,state:Ce,getters:a,mutations:o,actions:i};r["a"].use(qe["a"]);var He=new qe["a"].Store({modules:{main:We}});var Ve=He,_e=n("oYx3"),De=function(){var e="function"===typeof Ve?Ve():Ve,t="function"===typeof _e["a"]?Object(_e["a"])({store:e}):_e["a"];e.$router=t;var n={el:"#q-app",router:t,store:e,render:function(e){return e($e)}};return{app:n,store:e,router:t}},Xe=n("qSUR"),Je={failed:"Action failed",success:"Action was successful"},Ye={en:Je},Be=function(e){var t=e.app,n=e.Vue;n.use(Xe["a"]),t.i18n=new Xe["a"]({locale:"en",fallbackLocale:"en",messages:Ye})},Ke=n("vDqi"),Ze=n.n(Ke),et=function(e){var t=e.Vue;t.prototype.$axios=Ze.a},tt=n("wW6U"),nt=n.n(tt),at={namespace:"vuejs__",name:"ls",storage:"local"},ot=function(e){e.app;var t=e.Vue;t.use(nt.a,at)},it=n("3OSX"),rt=De(),st=rt.app,lt=rt.store,ut=rt.router;[Be,et,ot,it["a"]].forEach(function(e){e({app:st,router:ut,store:lt,Vue:r["a"],ssrContext:null})}),new r["a"](st)},TOJS:function(e,t,n){},fm0S:function(e,t,n){},oYx3:function(e,t,n){"use strict";n("f3/d");var a=n("Kw5r"),o=n("jE9Z"),i=[{path:"/auth",name:"login",component:function(){return n.e(3).then(n.bind(null,"Ga1e"))}},{path:"/",component:function(){return n.e(4).then(n.bind(null,"ez0Y"))},children:[{path:"",component:function(){return n.e(5).then(n.bind(null,"kmF/"))}},{path:"/messages/",component:function(){return n.e(6).then(n.bind(null,"RhWv"))}},{path:"/messages/view/:id",name:"ViewChat",component:function(){return n.e(7).then(n.bind(null,"S1bz"))},props:!0},{path:"/tasks/",component:function(){return n.e(8).then(n.bind(null,"34nD"))},children:[{path:"",component:function(){return n.e(9).then(n.bind(null,"9lP9"))}},{path:"view/inbox",component:function(){return n.e(0).then(n.bind(null,"U7oy"))},props:{path:"inbox"}},{path:"view/outbox",component:function(){return n.e(0).then(n.bind(null,"U7oy"))},props:{path:"outbox"}},{path:"create",name:"newTask",component:function(){return n.e(10).then(n.bind(null,"45c1"))},props:!0}]},{path:"/users/",component:function(){return n.e(11).then(n.bind(null,"ZXG/"))}},{path:"/docs/waybills/",component:function(){return n.e(12).then(n.bind(null,"vcyu"))}},{path:"/docs/waybills/detail/:id",name:"detailWaybill",component:function(){return n.e(1).then(n.bind(null,"bvBj"))},props:!0},{path:"/docs/waybills/new",name:"newWaybill",component:function(){return n.e(1).then(n.bind(null,"bvBj"))}},{path:"/docs/outfits/",name:"OutfitList",component:function(){return n.e(13).then(n.bind(null,"cI9m"))}},{path:"/docs/outfits/new",name:"OutfitNew",component:function(){return n.e(14).then(n.bind(null,"61sT"))}},{path:"/docs/tractor-regform/",name:"TractorRegForm",component:function(){return n.e(15).then(n.bind(null,"ZqoW"))}},{path:"/docs/tractor-regform/new/",name:"NewTractorRegForm",component:function(){return n.e(16).then(n.bind(null,"6QFO"))}},{path:"/docs/svodnaya-vedomost/",name:"SvodnayaVedomost",component:function(){return n.e(17).then(n.bind(null,"4MtE"))}},{path:"/docs/svodnaya-vedomost/new/",name:"NewSvodnayaVedomost",component:function(){return n.e(18).then(n.bind(null,"UDtT"))}},{path:"/docs/nakopitelnaya-vedomost/",name:"NakopitelnayaVedomost",component:function(){return n.e(19).then(n.bind(null,"+dgO"))}},{path:"/docs/nakopitelnaya-vedomost/new/",name:"NewNakopitelnayaVedomost",component:function(){return n.e(20).then(n.bind(null,"ZTUr"))}},{path:"/docs/worktime-table/",name:"WorkTimeTable",component:function(){return n.e(21).then(n.bind(null,"kPX8"))}},{path:"/docs/worktime-table/new/",name:"WorkTimeTableNew",component:function(){return n.e(22).then(n.bind(null,"Xm3j"))}},{path:"/docs/material-reports/",name:"MaterialReports",component:function(){return n.e(23).then(n.bind(null,"6sQl"))}}]},{path:"/print/outfit/:id",name:"outfitsPrint",component:function(){return n.e(24).then(n.bind(null,"xDAa"))},props:!0},{path:"/print/waybill-l/:id",name:"PrintWaybill-l",component:function(){return n.e(25).then(n.bind(null,"TqsR"))},props:!0},{path:"/print/waybill-h/:id",name:"PrintWaybill-h",component:function(){return n.e(26).then(n.bind(null,"r66C"))},props:!0},{path:"/print/regform/:id",name:"PrintRegForm",component:function(){return n.e(27).then(n.bind(null,"CYH9"))},props:!0},{path:"/print/svodnaya-vedomost/:id",name:"PrintSvodnayaVedomost",component:function(){return n.e(28).then(n.bind(null,"1Z+l"))},props:!0},{path:"/print/nakopitelnaya-vedomost/:id",name:"PrintNakopitelnayaVedomost",component:function(){return n.e(29).then(n.bind(null,"Zta2"))},props:!0},{path:"/print/worktime-table/:id",name:"WorkTimeTablePrint",component:function(){return n.e(30).then(n.bind(null,"Qmyi"))},props:!0},{path:"*",name:"NotFound",component:function(){return n.e(31).then(n.bind(null,"7l0S"))}}];a["a"].use(o["a"]);var r=new o["a"]({mode:"hash",base:"/app/",scrollBehavior:function(){return{y:0}},routes:i});r.beforeEach(function(e,t,n){"login"==e.name||a["a"].prototype.$auth.authenticated()?n():n("/auth")});t["a"]=r}},[[0,33,32]]]);