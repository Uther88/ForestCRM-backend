(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[9],{"9lP9":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("div",{staticClass:"row justify-start q-pa-sm bg-grey-2 justify-center"},[a("div",{staticClass:"col-sx-4"},[a("q-datetime",{attrs:{placeholder:"Дата",format:"D/MM/YYYY","hide-underline":"",color:"green",before:[{icon:"today"}]},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}})],1),a("div",{staticClass:"col-sx-5"},[a("q-select",{attrs:{placeholder:"Сотрудник","hide-underline":"",options:t.getStatsUsers,filter:""},model:{value:t.user,callback:function(e){t.user=e},expression:"user"}})],1)]),a("div",{staticClass:"row justify-center"},[a("div",{staticClass:"col"},[a("q-table",{attrs:{columns:t.columns,data:t.tableData,"row-key":"id",loading:t.loading}})],1)])])},i=[];n._withStripped=!0;a("KKXr");var s={name:"TasksMainPage",data:function(){return{loading:!1,date:(new Date).toISOString(),user:this.$user.id,tableData:[],columns:[{name:"username",label:"Ф.И.О.",field:"username",align:"center"},{name:"position",label:"Должность",field:"position",align:"center"},{name:"completed",label:"Выполненых",field:"completed",align:"center"},{name:"uncompleted",label:"Не выполненых",field:"uncompleted",align:"center"},{name:"overdue",label:"Просроченных",field:"overdue",align:"center"}]}},methods:{getStatistic:function(){var t=this;if(this.date&&this.user){var e={performer:this.user,to_complete__contains:this.date.split("T")[0]};this.$axios.get("/api/v1/task/",{params:e}).then(function(e){t.handleData(e.data)}).catch(function(t){})}},handleData:function(t){if(this.tableData=[],t&&t.meta.total_count){var e={};e.username=t.tasks[0].performer.full_name,e.position=t.tasks[0].performer.position,e.completed=t.tasks.filter(function(t){return t.is_completed}).length,e.uncompleted=t.tasks.filter(function(t){if(!t.is_completed)return new Date(t.to_complete)>new Date}).length,e.overdue=t.tasks.filter(function(t){if(!t.is_completed)return new Date(t.to_complete)<new Date}).length,this.tableData.push(e)}}},mounted:function(){this.getStatistic()},watch:{user:function(t){t&&this.getStatistic()},date:function(t){t&&this.getStatistic()}},computed:{getStatsUsers:function(){if(this.$user.is_staff){var t=this.$store.state.main.users.slice();return t.map(function(t){return{label:t.full_name,value:t.id}})}return[this.$user].map(function(t){return{label:t.full_name,value:t.id}})}}},l=s,r=(a("bfo+"),a("KHd+")),o=Object(r["a"])(l,n,i,!1,null,null,null);e["default"]=o.exports},"bfo+":function(t,e,a){"use strict";var n=a("dINs"),i=a.n(n);i.a},dINs:function(t,e,a){}}]);